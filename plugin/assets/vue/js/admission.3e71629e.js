(function(e){function t(t){for(var n,o,u=t[0],a=t[1],c=t[2],d=0,p=[];d<u.length;d++)o=u[d],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&p.push(i[o][0]),i[o]=0;for(n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n]);l&&l(t);while(p.length)p.shift()();return s.push.apply(s,c||[]),r()}function r(){for(var e,t=0;t<s.length;t++){for(var r=s[t],n=!0,u=1;u<r.length;u++){var a=r[u];0!==i[a]&&(n=!1)}n&&(s.splice(t--,1),e=o(o.s=r[0]))}return e}var n={},i={admission:0},s=[];function o(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=e,o.c=n,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(r,n,function(t){return e[t]}.bind(null,n));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/plugins_packages/uaux/BundleAllocationPlugin/views/";var u=window["webpackJsonp"]=window["webpackJsonp"]||[],a=u.push.bind(u);u.push=t,u=u.slice();for(var c=0;c<u.length;c++)t(u[c]);var l=a;s.push([2,"chunk-vendors"]),r()})({"0604":function(e,t,r){"use strict";var n=r("d143"),i=r.n(n);i.a},2:function(e,t,r){e.exports=r("2ccb")},"2ccb":function(e,t,r){"use strict";r.r(t);r("cadf"),r("551c"),r("f751"),r("097d");var n=r("2b0e"),i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"app"}},[0!==e.error.length?r("div",{staticClass:"messagebox messagebox_error"},[r("div",{staticClass:"messagebox_buttons"},[r("a",{staticClass:"close",attrs:{href:"#",title:"Nachrichtenbox schliessen"},on:{click:function(t){t.preventDefault(),e.error=""}}},[r("span",[e._v("Nachrichtenbox schliessen")])])]),e._v("\n        "+e._s(e.error)+"\n    ")]):e._e(),!0===e.success?r("div",{staticClass:"messagebox messagebox_success"},[r("div",{staticClass:"messagebox_buttons"},[r("a",{staticClass:"close",attrs:{href:"#",title:"Nachrichtenbox schliessen"},on:{click:function(t){t.preventDefault(),e.success=!1}}},[r("span",[e._v("Nachrichtenbox schliessen")])])]),e._v("\n        Prioritäten wurden gespeichert\n    ")]):e._e(),0===e.groups.length?r("div",{staticClass:"messagebox messagebox_info"},[e._v("\n        Keine Anmeldungen vorhanden.\n    ")]):e._e(),e._l(e.groups,(function(e){return r("GroupTable",{key:e.group_id,attrs:{group:e}})})),e.groups.length>0?r("button",{staticClass:"button",on:{click:e.submit}},[e._v("Speichern")]):e._e(),e.groups.length>0?r("button",{staticClass:"button",on:{click:function(t){return t.preventDefault(),e.submitAndEnroll(t)}}},[e._v("Speichern und eintragen")]):e._e()],2)},s=[],o=(r("8e6e"),r("ac6a"),r("456d"),r("bd86")),u=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("table",{staticClass:"default"},[r("caption",[e._v("\n        "+e._s(e.group.group_name)+" ("+e._s(e.group.users.length)+" Anmeldungen)\n    ")]),e._m(0),e._m(1),e._l(e.sortedUsers,(function(t){return r("UserEntry",{key:t.user_id,attrs:{user:t,availableCourses:e.availableCourses,groupId:e.group.group_id}})}))],2)},a=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("colgroup",[r("col",{attrs:{width:"20px"}}),r("col",{attrs:{width:"25%"}}),r("col",{attrs:{width:"25%"}}),r("col",{attrs:{width:"7px"}}),r("col",{attrs:{width:"7px"}}),r("col",{attrs:{width:"75%"}})])},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("thead",[r("tr",[r("th"),r("th",[e._v("Nachname")]),r("th",[e._v("Vorname")]),r("th",[e._v("Priorität")]),r("th",[e._v("Warteliste")]),r("th",[e._v("Veranstaltung")])])])}],c=(r("7f7f"),r("55dd"),function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("tbody",[r("tr",[r("th",{on:{click:function(t){e.open=!e.open}}},[e.open?r("svg",{attrs:{width:"16",height:"16",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16","shape-rendering":"geometricPrecision",fill:"#24437c"}},[r("path",{attrs:{d:"M8 7.912L3.512 3.428 1.186 5.756l6.817 6.816 6.811-6.814-2.328-2.33z"}})]):r("svg",{attrs:{width:"16",height:"16",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16","shape-rendering":"geometricPrecision",fill:"#24437c"}},[r("path",{attrs:{d:"M7.912 8l-4.484 4.488 2.328 2.326 6.816-6.818-6.814-6.81-2.33 2.328z"}})])]),r("th",{on:{click:function(t){e.open=!e.open}}},[e._v(e._s(e.user.nachname))]),r("th",{on:{click:function(t){e.open=!e.open}}},[e._v(e._s(e.user.vorname))]),r("th",{on:{click:function(t){e.open=!e.open}}},[e._v(e._s(e.prioritySelected)+" / "+e._s(e.user.items.length))]),r("th",{staticStyle:{"text-align":"center"}},[r("label",[r("input",{directives:[{name:"model",rawName:"v-model",value:e.waitlist,expression:"waitlist"}],attrs:{type:"checkbox",disabled:"noallocation"===e.allocatedCourse},domProps:{checked:Array.isArray(e.waitlist)?e._i(e.waitlist,null)>-1:e.waitlist},on:{change:function(t){var r=e.waitlist,n=t.target,i=!!n.checked;if(Array.isArray(r)){var s=null,o=e._i(r,s);n.checked?o<0&&(e.waitlist=r.concat([s])):o>-1&&(e.waitlist=r.slice(0,o).concat(r.slice(o+1)))}else e.waitlist=i}}})])]),r("th",[r("label",[r("select",{directives:[{name:"model",rawName:"v-model",value:e.allocatedCourse,expression:"allocatedCourse"}],on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.allocatedCourse=t.target.multiple?r:r[0]}}},[r("option",{attrs:{hidden:"",value:"noallocation"}},[e._v("Noch keine zugeteilte Veranstaltung")]),e._l(e.availableCourses,(function(t){return r("option",{key:t.course.seminar_id,domProps:{value:{itemId:t.item_id,seminarId:t.course.seminar_id}}},[e._v("\n                    "+e._s(t.course.name)+" ("+e._s(e.amountParticipants(e.groupId,t.course.seminar_id))+" / "+e._s(t.course.capacity)+")\n                ")])}))],2)])])]),e._l(e.user.items,(function(t,n){return[e.open?r("tr",{key:t.item_id},[r("td"),r("td"),r("td"),r("td",[e._v(e._s(n+1))]),r("td"),r("td",e._l(t.courses,(function(t){return r("ul",{key:t.seminar_id},[r("li",[r("strong",[e._v(e._s(t.name))]),r("br"),r("span",{domProps:{innerHTML:e._s(t.formatted_date)}})])])})),0)]):e._e()]}))],2)}),l=[],d=(r("20d6"),r("2f62"));function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){Object(o["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var h={name:"UserEntry",props:["user","groupId","availableCourses"],data:function(){return{open:!1}},computed:f({},Object(d["b"])(["amountParticipants"]),{allocatedCourse:{get:function(){if(null==this.$store.getters.allocatedCourse(this.user.user_id,this.groupId))return"noallocation";var e=this.$store.getters.allocatedCourse(this.user.user_id,this.groupId);return{itemId:e.item_id,seminarId:e.seminar_id}},set:function(e){this.$store.dispatch("setPrelimCourse",{groupId:this.groupId,userId:this.user.user_id,itemId:e.itemId,seminarId:e.seminarId,priority:this.user.items.findIndex((function(t){return t.item_id===e.itemId}))})}},waitlist:{get:function(){return null!=this.$store.getters.allocatedCourse(this.user.user_id,this.groupId)&&this.$store.getters.allocatedCourse(this.user.user_id,this.groupId).waitlist},set:function(e){"noallocation"!==this.allocatedCourse&&this.$store.dispatch("setPrelimWaitlist",{groupId:this.groupId,userId:this.user.user_id,waitlist:e})}},prioritySelected:function(){var e=this;if("noallocation"!==this.allocatedCourse){var t=this.user.items.findIndex((function(t){return t.item_id===e.allocatedCourse.itemId}));return-1===t?"?":t+1}return"?"}})},m=h,g=(r("0604"),r("2877")),_=Object(g["a"])(m,c,l,!1,null,"03a672bb",null),v=_.exports,b={name:"GroupTable",components:{UserEntry:v},props:["group"],data:function(){return{currentSort:"nachname",currentSortDir:"asc"}},computed:{availableCourses:function(){return this.group.available_courses.slice().sort((function(e,t){return e.course.name.localeCompare(t.course.name)}))},sortedUsers:function(){var e=this;return this.group.users.slice().sort((function(t,r){var n=1;return"desc"===e.currentSortDir&&(n=-1),t[e.currentSort]<r[e.currentSort]?-1*n:t[e.currentSort]>r[e.currentSort]?1*n:0}))}}},w=b,y=Object(g["a"])(w,u,a,!1,null,"581eae22",null),O=y.exports,I=r("bc3a"),P=r.n(I);function j(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function x(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?j(Object(r),!0).forEach((function(t){Object(o["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var C={name:"app",components:{GroupTable:O},data:function(){return{error:"",success:!1}},computed:x({},Object(d["c"])(["groups","prelim","coursesetId"])),methods:{submitAndEnroll:function(){var e=this;STUDIP.Dialog.confirm("Die Teilnehmer werden hiermit in die entsprechenden Veranstaltungen eingetragen. Soll die Eintragung durchgeführt werden?",(function(){e.submit(!0)}))},submit:function(e){var t=this,r={finalize:!1};!0===e&&(r.finalize=!0),P.a.post("/plugins.php/bundleallocationplugin/admission/submit_alloc/"+this.coursesetId,this.prelim,{params:r}).then((function(){t.success=!0,t.error=""})).catch((function(e){console.log(e),t.error="Zugeteilte Veranstaltungen konnten nicht gespeichert werden.",t.success=!1}))}}},k=C,S=Object(g["a"])(k,i,s,!1,null,null,null),D=S.exports;r("7514");n["a"].use(d["a"]);var E=new d["a"].Store({state:BUNDLEALLOCATION_APPLICATIONS,getters:{amountParticipants:function(e){return function(t,r){return e.prelim.reduce((function(e,n){var i=n.groups.find((function(e){return e.group_id===t}));return null!=i&&i.seminar_id===r&&(e+=1),e}),0)}},allocatedCourse:function(e){return function(t,r){var n=e.prelim.find((function(e){return e.user_id===t}));if(null!=n)return n.groups.find((function(e){return e.group_id===r}))}}},mutations:{setPrelimCourse:function(e,t){var r=t.groupId,n=t.userId,i=t.itemId,s=t.seminarId,o=t.priority,u=e.prelim.find((function(e){return e.user_id===n}));if(null!=u){var a=u.groups.find((function(e){return e.group_id===r}));null!=a?(a.item_id=i,a.seminar_id=s,a.priority=o):u.groups.push({group_id:r,item_id:i,seminar_id:s,priority:o,waitlist:!1})}else e.prelim.push({user_id:n,groups:[{group_id:r,item_id:i,seminar_id:s,priority:o,waitlist:!1}]})},setPrelimWaitlist:function(e,t){var r=t.groupId,n=t.userId,i=t.waitlist,s=e.prelim.find((function(e){return e.user_id===n}));if(null!=s){var o=s.groups.find((function(e){return e.group_id===r}));null!=o&&(o.waitlist=i)}}},actions:{setPrelimCourse:function(e,t){var r=e.commit,n=t.groupId,i=t.userId,s=t.itemId,o=t.seminarId,u=t.priority;r("setPrelimCourse",{groupId:n,userId:i,itemId:s,seminarId:o,priority:u})},setPrelimWaitlist:function(e,t){var r=e.commit,n=t.groupId,i=t.userId,s=t.waitlist;r("setPrelimWaitlist",{groupId:n,userId:i,waitlist:s})}}});n["a"].config.productionTip=!1,new n["a"]({store:E,render:function(e){return e(D)}}).$mount("#app")},d143:function(e,t,r){}});
//# sourceMappingURL=admission.3e71629e.js.map